<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compress Video to 8MB for Discord (Offline, No Upload)</title>
<meta name="description" content="Free, privacy-first video compressor to 8MB for Discord uploads. Runs entirely in your browser with no uploads. Fast, secure, and mobile-friendly.">
<style>
  body { font-family: Arial, sans-serif; max-width: 800px; margin: auto; padding: 20px; }
  h1 { text-align: center; }
  .uploader { border: 2px dashed #ccc; padding: 20px; text-align: center; cursor: pointer; }
  #output { margin-top: 20px; }
  .faq { margin-top: 40px; }
</style>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</head>
<body>
<h1>Compress Video to 8MB for Discord (Offline)</h1>
<p>This free tool compresses videos to under 8MB for Discord sharing — all in your browser. No uploads, no server processing, complete privacy.</p>
<div class="uploader" id="uploader">
  Drop your video here or click to select
  <input id="fileInput" type="file" accept="video/*" hidden>
</div><div id="output"></div>
<!-- AdSense slot -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-xxxxxxxxxxxxxxxx" data-ad-slot="1234567890" data-ad-format="auto"></ins>
<script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
<div class="faq">
<h2>Frequently Asked Questions</h2>
<h3>Why 8MB?</h3>
<p>Discord’s free tier limits file uploads to 8MB. Compressing your videos ensures they can be sent without Nitro.</p>
<h3>Is my video uploaded?</h3>
<p>No. All processing happens locally in your browser via WebAssembly (<code>ffmpeg.wasm</code>). Your video never leaves your device.</p>
<h3>Does it work offline?</h3>
<p>Yes. Once loaded, you can use it without an internet connection.</p>
<h3>What formats are supported?</h3>
<p>MP4, MOV, WebM, and more — if your browser can decode it, we can compress it.</p>
</div>
<!-- SEO content -->
<section>
<h2>Free Discord Video Compressor – 8MB Limit</h2>
<p>Need to share a video on Discord but keep hitting the 8MB limit? Our free Discord video compressor lets you shrink any clip to fit under the size cap. Works on Windows, Mac, Linux, Android, and iOS directly in your browser.</p>
<h3>Key Features</h3>
<ul>
<li><strong>Privacy-first:</strong> No uploads, 100% local processing.</li>
<li><strong>Fast:</strong> Powered by WebAssembly and <code>ffmpeg</code>.</li>
<li><strong>Customizable:</strong> Trim length, adjust resolution, mute audio.</li>
<li><strong>Multiple targets:</strong> 8MB default, plus 25MB, 50MB, 100MB options.</li>
</ul>
<h3>How to Compress Video for Discord</h3>
<ol>
<li>Click the upload box and select your video file.</li>
<li>Choose your target size (8MB for Discord free tier).</li>
<li>Adjust optional settings like resolution and audio.</li>
<li>Click “Compress” and wait for processing to finish.</li>
<li>Download your optimized file and send it on Discord.</li>
</ol>
</section>
<script>
  // --- Basic working uploader + compressor (client-side only) ---
  const $ = s => document.querySelector(s);
  const uploader = $('#uploader');
  const fileInput = $('#fileInput');
  const output = $('#output');

  let srcFile = null, srcBytes = null, srcDuration = 0, lastBlob = null;

  // Click to open file dialog
  uploader.addEventListener('click', ()=> fileInput.click());
  fileInput.addEventListener('change', e=>{
    const f = e.target.files && e.target.files[0];
    if (f) handleFile(f);
  });

  // Drag & drop
  ['dragenter','dragover'].forEach(ev => uploader.addEventListener(ev, e=>{
    e.preventDefault(); uploader.style.background = '#f6f8ff';
  }));
  ['dragleave','drop'].forEach(ev => uploader.addEventListener(ev, e=>{
    e.preventDefault(); uploader.style.background = '';
  }));
  uploader.addEventListener('drop', e=>{
    const f = e.dataTransfer.files && e.dataTransfer.files[0];
    if (f) handleFile(f);
  });

  function fmtBytes(n){
    if (n < 1024) return n+' B';
    if (n < 1048576) return (n/1024).toFixed(1)+' KB';
    return (n/1048576).toFixed(2)+' MB';
  }

  async function handleFile(file){
    srcFile = file;
    srcBytes = new Uint8Array(await file.arrayBuffer());
    srcDuration = await getDuration(new Blob([srcBytes], {type:file.type || 'video/mp4'}));
    lastBlob = null;

    output.innerHTML = `
      <div style="border:1px solid #ddd;border-radius:10px;padding:12px">
        <div><b>Selected:</b> ${file.name} · ${fmtBytes(file.size)} · ${srcDuration ? srcDuration.toFixed(2)+'s' : 'unknown'}</div>
        <div style="margin-top:10px;display:grid;grid-template-columns:1fr 1fr;gap:10px">
          <label>Target size
            <select id="targetSize">
              <option value="8">8 MB (Discord)</option>
              <option value="25">25 MB</option>
              <option value="50">50 MB</option>
              <option value="100">100 MB</option>
            </select>
          </label>
          <label>Max resolution
            <select id="maxRes">
              <option value="auto">Auto</option>
              <option value="1080">1080p</option>
              <option value="720" selected>720p</option>
              <option value="480">480p</option>
              <option value="360">360p</option>
            </select>
          </label>
          <label>Trim start (s)
            <input id="trimStart" type="number" min="0" step="0.1" placeholder="0">
          </label>
          <label>Trim end (s)
            <input id="trimEnd" type="number" min="0" step="0.1" placeholder="leave blank">
          </label>
          <label style="grid-column: span 2; display:flex; align-items:center; gap:8px">
            <input id="mute" type="checkbox"> Mute audio
          </label>
        </div>
        <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap">
          <button id="startBtn">Compress</button>
          <button id="dlBtn" disabled>Download</button>
          <span id="status">Status: idle</span>
        </div>
        <progress id="prog" value="0" max="1" style="width:100%;height:14px;margin-top:10px;display:none"></progress>
        <pre id="log" style="display:none;background:#0c1127;color:#b9c3ff;border-radius:8px;padding:8px;max-height:180px;overflow:auto"></pre>
      </div>`;

    $('#startBtn').addEventListener('click', startCompress);
    $('#dlBtn').addEventListener('click', downloadOut);
  }

  function getDuration(blob){
    return new Promise(res=>{
      const v = document.createElement('video'); v.preload='metadata';
      v.onloadedmetadata = ()=>{ const d=v.duration; URL.revokeObjectURL(v.src); res(isFinite(d)? d : 0); };
      v.onerror = ()=>{ URL.revokeObjectURL(v.src); res(0); };
      v.src = URL.createObjectURL(blob);
    });
  }

  function setStatus(t){ const s=$('#status'); if(s) s.textContent='Status: '+t; }
  function logLine(t){ const l=$('#log'); if(!l) return; l.style.display='block'; l.textContent += t+'\\n'; l.scrollTop=l.scrollHeight; }

  // FFmpeg setup
  const { createFFmpeg } = FFmpeg;
  const ffmpeg = createFFmpeg({
    log: false,
    corePath: 'https://unpkg.com/@ffmpeg/core@0.12.4/dist/ffmpeg-core.js'
  });

  async function startCompress(){
    try{
      setStatus('Loading FFmpeg…');
      const prog = $('#prog'); prog.style.display='block'; prog.value=0;
      if(!ffmpeg.isLoaded()){
        ffmpeg.setProgress(({ratio})=>{ prog.value = Math.max(0, Math.min(1, ratio || 0)); });
        await ffmpeg.load();
      }

      setStatus('Preparing…');
      const inExt = (srcFile?.name.split('.').pop() || 'mp4').toLowerCase();
      const inName = 'input.'+inExt;
      const outName = 'out.mp4';
      try{ ffmpeg.FS('unlink', inName); }catch(_){}
      try{ ffmpeg.FS('unlink', outName); }catch(_){}
      ffmpeg.FS('writeFile', inName, srcBytes);

      const targetMB = parseInt($('#targetSize').value,10) || 8;
      const targetBytes = targetMB * 1024 * 1024;
      const trimStart = parseFloat($('#trimStart').value || '0') || 0;
      const trimEnd = parseFloat($('#trimEnd').value || '0') || 0;
      const mute = $('#mute').checked;
      const maxRes = $('#maxRes').value;

      const estDur = Math.max(0.5, (srcDuration || 0) - trimStart - (trimEnd>0 ? Math.max(0, (srcDuration||0) - trimEnd) : 0));
      const audioK = mute ? 0 : 96; // kbps
      const overhead = 0.92; // container headroom
      let vbK = Math.max(100, Math.floor(((targetBytes*8)/estDur)/1000 - audioK) * overhead);

      // scaling
      let vf = [];
      if(maxRes !== 'auto'){
        const h = parseInt(maxRes,10);
        vf = ['-vf', `scale='min(iw,round(ih*(${h}/ih)))':${h}:force_original_aspect_ratio=decrease`];
      }

      const base = [
        ...(trimStart>0? ['-ss', String(trimStart)] : []),
        ...(trimEnd>0? ['-to', String(trimEnd)] : []),
        '-i', inName,
        '-c:v','libx264','-preset','veryfast','-pix_fmt','yuv420p','-movflags','+faststart',
        ...vf,
        ...(mute ? ['-an'] : ['-c:a','aac','-b:a', audioK+'k'])
      ];

      // 1st pass
      let args = [...base, '-b:v', vbK+'k', '-maxrate', vbK+'k', '-bufsize', Math.round(vbK/2)+'k', outName];
      setStatus(`Encoding (~${vbK} kbps)…`);
      await ffmpeg.run(...args);
      let data = ffmpeg.FS('readFile', outName);

      // If overshoot, refine once
      if(data.length > targetBytes){
        const ratio = targetBytes / data.length;
        vbK = Math.max(100, Math.floor(vbK * ratio * 0.9));
        setStatus(`Refining size (~${vbK} kbps)…`);
        try{ ffmpeg.FS('unlink', outName); }catch(_){}
        args = [...base, '-b:v', vbK+'k', '-maxrate', vbK+'k', '-bufsize', Math.round(vbK/2)+'k', outName];
        await ffmpeg.run(...args);
        data = ffmpeg.FS('readFile', outName);
      }

      lastBlob = new Blob([data.buffer], {type:'video/mp4'});
      const finalMB = (data.length/1048576).toFixed(2);
      setStatus(`Done: ${finalMB} MB${data.length <= targetBytes ? ' ✓' : ' (slightly over)'}`);
      $('#dlBtn').disabled = false;
      prog.style.display='none';
    }catch(err){
      console.error(err);
      logLine(String(err));
      setStatus('Error');
      $('#prog').style.display='none';
    }
  }

  function downloadOut(){
    if(!lastBlob) return;
    const a = document.createElement('a');
    a.href = URL.createObjectURL(lastBlob);
    a.download = (srcFile?.name.replace(/\\.[^.]+$/, '') || 'video') + `-discord-${$('#targetSize').value}MB.mp4`;
    a.click();
    setTimeout(()=> URL.revokeObjectURL(a.href), 1500);
  }
</script>
</body>
</html>
